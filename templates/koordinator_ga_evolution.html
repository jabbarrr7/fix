{% extends "koordinator.html" %}
{% block content %}
<div class="container mt-4">
  <h2>Visualisasi Evolusi Genetic Algorithm</h2>
  <canvas id="gaEvolutionChart" width="800" height="400"></canvas>
  <div class="mt-3">
    <a href="{{ url_for('schedule') }}" class="btn btn-secondary">Kembali ke Jadwal Hybrid</a>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
async function fetchGAEvolution() {
  const response = await fetch("/api/ga_evolution");
  if (!response.ok) return null;
  return await response.json();
}

function renderChart(data) {
  const ctx = document.getElementById('gaEvolutionChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: data.generation,
      datasets: [
        {
          label: 'Fitness Minimum',
          data: data.fitness_min,
          borderColor: 'rgba(255, 99, 132, 1)',
          backgroundColor: 'rgba(255, 99, 132, 0.2)',
          fill: false,
        },
        {
          label: 'Fitness Rata-rata',
          data: data.fitness_avg,
          borderColor: 'rgba(54, 162, 235, 1)',
          backgroundColor: 'rgba(54, 162, 235, 0.2)',
          fill: false,
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'top' },
        title: { display: true, text: 'Evolusi Fitness GA per Generasi' }
      },
      scales: {
        x: { title: { display: true, text: 'Generasi' } },
        y: { title: { display: true, text: 'Fitness' } }
      }
    }
  });
}

fetchGAEvolution().then(data => {
  if (data) renderChart(data);
  else document.getElementById('gaEvolutionChart').replaceWith('Data tidak tersedia.');
});
</script>
{% endblock %}
